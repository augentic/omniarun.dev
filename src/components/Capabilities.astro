---
const capabilities = [
  {
    trait: "Config",
    label: "Configuration",
    desc: "Environment variables, URLs, and feature flags — without std::env.",
    icon: "⚙",
  },
  {
    trait: "HttpRequest",
    label: "HTTP",
    desc: "Outbound HTTP calls routed through the host. No reqwest, no hyper.",
    icon: "↗",
  },
  {
    trait: "Publish",
    label: "Messaging",
    desc: "Publish events to Kafka topics with typed Message structs.",
    icon: "◈",
  },
  {
    trait: "StateStore",
    label: "State",
    desc: "Key-value persistence and caching, backed by the host's store.",
    icon: "▦",
  },
  {
    trait: "Identity",
    label: "Auth",
    desc: "OAuth and Azure AD tokens acquired by the host, passed to your code.",
    icon: "△",
  },
  {
    trait: "TableStore",
    label: "SQL",
    desc: "Typed database queries via sea-query, executed host-side.",
    icon: "▤",
  },
  {
    trait: "Broadcast",
    label: "WebSocket",
    desc: "Real-time send and reply over WebSocket connections.",
    icon: "◉",
  },
];
---

<section id="capabilities" class="relative py-24 sm:py-32">
  <!-- Divider -->
  <div class="mx-auto max-w-6xl px-6 lg:px-8">
    <div class="mb-20 h-px bg-gradient-to-r from-transparent via-rule to-transparent"></div>
  </div>

  <div class="mx-auto max-w-6xl px-6 lg:px-8">
    <div class="max-w-2xl">
      <p class="reveal mb-3 font-mono text-xs font-medium uppercase tracking-[0.2em] text-copper">
        Provider Traits
      </p>
      <h2 class="reveal reveal-delay-1 font-display text-3xl font-bold leading-tight tracking-tight sm:text-4xl">
        Seven capabilities.<br/>
        <span class="text-ink-muted">Zero direct access.</span>
      </h2>
      <p class="reveal reveal-delay-2 mt-4 text-base leading-relaxed text-ink-muted sm:text-lg">
        Every external operation your WASM guest needs is expressed as a Rust trait.
        Compose only what you use — fewer bounds means more testable, more auditable code.
      </p>
    </div>

    <div class="mt-14 grid gap-3 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
      {capabilities.map((cap, i) => (
        <div
          class={`reveal reveal-delay-${i + 1} group relative rounded-xl border border-rule bg-surface/60 p-6 transition-all duration-300 hover:border-copper/40 hover:bg-surface hover:shadow-md hover:shadow-copper/5`}
        >
          <div class="mb-4 flex items-center justify-between">
            <span class="text-2xl leading-none" aria-hidden="true">{cap.icon}</span>
            <span class="rounded-full border border-rule bg-parchment px-2.5 py-0.5 font-mono text-[11px] font-medium text-copper">
              {cap.trait}
            </span>
          </div>
          <h3 class="font-display text-lg font-semibold">{cap.label}</h3>
          <p class="mt-1.5 text-sm leading-relaxed text-ink-muted">{cap.desc}</p>
          <!-- Hover accent line -->
          <div class="absolute bottom-0 left-6 right-6 h-px origin-left scale-x-0 bg-copper/40 transition-transform duration-300 group-hover:scale-x-100"></div>
        </div>
      ))}
    </div>

    <!-- Composition note -->
    <div class="reveal mt-10 flex items-start gap-3 rounded-lg border border-copper/20 bg-copper/5 p-5">
      <span class="mt-0.5 font-mono text-sm text-copper">→</span>
      <div>
        <p class="text-sm font-medium text-ink">Composition, not inheritance.</p>
        <p class="mt-1 text-sm text-ink-muted">
          Handler trait bounds are the union of all capabilities the function calls.
          A handler that only reads config and makes HTTP calls declares
          <code class="rounded bg-surface px-1.5 py-0.5 font-mono text-xs text-copper">P: Config + HttpRequest</code>
          — nothing more.
        </p>
      </div>
    </div>
  </div>
</section>
